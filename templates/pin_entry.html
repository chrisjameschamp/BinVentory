{% extends "base.html" %}

{% block title %}BinVentory - Enter Pin{% endblock %}

{% block content %}
<h2 class="text-uppercase fs-6 text-center custom-blue">Enter Pin</h2>
<div class="d-flex justify-content-center" style="height: 100vh;">
    <div class="text-center">
        <!-- PIN Entry Form -->
        <form method="POST" action="{{ url_for('pin_entry') }}">
            <!-- Hidden input field to store the entered PIN -->
            <input type="hidden" name="pin" id="hiddenPin">

            <!-- PIN Display Box (non-editable) -->
            <input type="text" id="pinDisplay" class="form-control mb-3 text-center" value="" readonly style="font-size: 2rem; letter-spacing: 0.5rem; background-color: #f8f9fa; width: 250px; margin: 0 auto;">

            <!-- Pinpad -->
            <div class="row">
                <div class="col-4">
                    <button type="button" class="btn btn-outline-primary btn-lg w-100" onclick="enterPin('1')">1</button>
                </div>
                <div class="col-4">
                    <button type="button" class="btn btn-outline-primary btn-lg w-100" onclick="enterPin('2')">2</button>
                </div>
                <div class="col-4">
                    <button type="button" class="btn btn-outline-primary btn-lg w-100" onclick="enterPin('3')">3</button>
                </div>
            </div>
            <div class="row mt-2">
                <div class="col-4">
                    <button type="button" class="btn btn-outline-primary btn-lg w-100" onclick="enterPin('4')">4</button>
                </div>
                <div class="col-4">
                    <button type="button" class="btn btn-outline-primary btn-lg w-100" onclick="enterPin('5')">5</button>
                </div>
                <div class="col-4">
                    <button type="button" class="btn btn-outline-primary btn-lg w-100" onclick="enterPin('6')">6</button>
                </div>
            </div>
            <div class="row mt-2">
                <div class="col-4">
                    <button type="button" class="btn btn-outline-primary btn-lg w-100" onclick="enterPin('7')">7</button>
                </div>
                <div class="col-4">
                    <button type="button" class="btn btn-outline-primary btn-lg w-100" onclick="enterPin('8')">8</button>
                </div>
                <div class="col-4">
                    <button type="button" class="btn btn-outline-primary btn-lg w-100" onclick="enterPin('9')">9</button>
                </div>
            </div>
            <div class="row mt-2">
                <div class="col-4">
                    <button type="button" class="btn btn-warning btn-lg w-100" onclick="clearPin()">C</button>
                </div>
                <div class="col-4">
                    <button type="button" class="btn btn-outline-primary btn-lg w-100" onclick="enterPin('0')">0</button>
                </div>
                <div class="col-4">
                    <button type="submit" class="btn btn-success btn-lg w-100" onclick="submitPin()">OK</button>
                </div>
            </div>
        </form>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="mt-3">
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
    </div>
</div>

<script>
    let enteredPin = "";

    // Function to update the pin display
    function enterPin(digit) {
        enteredPin += digit;
        document.getElementById('pinDisplay').value = enteredPin;  // Display the entered digits
    }

    // Function to clear the entered PIN
    function clearPin() {
        enteredPin = "";
        document.getElementById('pinDisplay').value = "";
    }

    // Function to submit the PIN
    function submitPin() {
        // Assign the entered PIN to the hidden input field
        document.getElementById('hiddenPin').value = enteredPin;
    }
</script>
{% endblock %}
